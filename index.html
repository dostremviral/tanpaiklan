<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DoodStream Player</title>
<style>
  * {margin: 0; padding: 0; box-sizing: border-box;}
  html, body {
    width: 100%;
    height: 100%;
    background-color: #000;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .video-container {
    width: 100%;
    height: 100%;
    background: #000;
  }
  video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    background: #000;
  }
</style>
</head>
<body>

<div class="video-container" id="videoContainer" style="display:none;">
  <video id="videoPlayer" controls controlsList="nodownload noremoteplayback" disablePictureInPicture>
    <source id="videoSource" type="video/mp4">
    Browser kamu tidak mendukung video.
  </video>
</div>

<script>
// ==== Ambil ID Video dari URL ==== //
function getVideoId() {
  const url = window.location;
  let id = null;

  // Format 1: ?v=xxxx
  const params = new URLSearchParams(url.search);
  if (params.has('v')) {
    id = params.get('v');
  }

  // Format 2: ?/xxxx
  else if (url.search.startsWith('?/')) {
    id = url.search.slice(2);
  }

  // Format 3: /e/xxxx
  else if (url.pathname.startsWith('/e/')) {
    id = url.pathname.split('/e/')[1];
  }

  return id ? id.trim() : null;
}

// ==== Main Logic ==== //
(async () => {
  const videoId = getVideoId();
  const container = document.getElementById('videoContainer');
  const player = document.getElementById('videoPlayer');
  const source = document.getElementById('videoSource');

  if (!videoId) {
    alert('ID video tidak ditemukan di URL.');
    return;
  }

  try {
    const response = await fetch('https://raw.githubusercontent.com/DoodstreamPro/_e/refs/heads/main/Video.json');
    const data = await response.json();
    const video = data.find(v => v.id === videoId);

    if (video) {
      source.src = video.Url;
      container.style.display = 'block';
      player.load();
    } else {
      alert('Video dengan ID ini tidak ditemukan.');
    }
  } catch (err) {
    alert('Gagal memuat daftar video.');
    console.error(err);
  }

  // Nonaktifkan klik kanan
  player.addEventListener('contextmenu', e => e.preventDefault());
})();
</script>

</body>
</html>